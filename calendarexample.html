<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8' />
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css' />
	<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js'></script>
	<script>
		$(document).ready(function() {
			// define the calendar
			$('#calendar').fullCalendar({
				header: {
					left: 'prev,next today',
					center: 'title',
					right: 'month,agendaWeek,agendaDay'
				},
				events: function(start, end, timezone, callback) {
					$.ajax({
						url: 'https://events.tscpl.org/feeds?data=eyJmZWVkVHlwZSI6InJzcyIsImZpbHRlcnMiOnsibG9jYXRpb24iOlsiYWxsIl0sImFnZXMiOlsiYWxsIl0sInR5cGVzIjpbIlN1bW1lciBSZWFkaW5nIl0sInRhZ3MiOltdLCJ0ZXJtIjoiIiwiZGF5cyI6MX19',
						type: 'GET',
						dataType: 'xml',
						success: function(data) {
							// test if the XML data was imported correctly
							if ($(data).find('item').length == 0) {
								console.log('Error: No events found in the XML data.');
								return;
							}
							
							// parse the XML data and format it as events
							var events = [];
							$(data).find('item').each(function() {
								var event = {
									title: $(this).find('title').text(),
									start: $(this).find('pubDate').text(),
									description: $(this).find('description').text()
								};
								events.push(event);
							});
							
							// pass the events to the calendar
							callback(events);
						},
						error: function(xhr, status, error) {
							console.log('Error: ' + error);
						}
					});
				},
				eventClick: function(event) {
					// display event details in a popup
					alert('Title: ' + event.title + '\nStart: ' + event.start.format('YYYY-MM-DD HH:mm:ss') + '\nDescription: ' + event.description);
				}
			});
		});
	</script>
</head>
<body>
	<div id='calendar'></div>
</body>
</html>
